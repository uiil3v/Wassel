{% extends "student/base_student.html" %}

{% block student_content %}

<style>
    .dashboard-welcome {
        background: white;
        border-radius: 35px;
        padding: 40px;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.05);
        margin-bottom: 40px;
    }

    .status-card {
        background: white;
        border-radius: 30px;
        padding: 30px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.05);
        margin-bottom: 30px;
    }

    .subscription-card {
        background: white;
        border-radius: 30px;
        padding: 30px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.05);
        transition: 0.3s ease;
        height: 100%;
    }

    .subscription-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 30px 70px rgba(0, 0, 0, 0.08);
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }

    .info-row span:first-child {
        color: var(--soft-color);
    }
</style>

<!-- ===== Welcome ===== -->
<div class="dashboard-welcome">
    <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒØŒ {{ user.first_name }} ğŸ‘‹</h3>
    <p class="text-muted mt-2">
        Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ø´ØªØ±Ø§ÙƒÙƒ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§ØªÙƒ.
    </p>
</div>


{% if not active_request %}

<!-- ===== No Subscription ===== -->
<div class="status-card text-center">
    <h5 class="fw-bold mb-3">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø¯ÙŠÙƒ Ø§Ø´ØªØ±Ø§Ùƒ Ø­Ø§Ù„ÙŠØ§Ù‹</h5>
    <p class="text-muted mb-4">
        ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙˆØ§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„Ùƒ.
    </p>

    <a href="{% url 'student:subscriptions' %}" class="btn btn-accent">
        Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª
    </a>
</div>


{% elif active_request.status == "pending" %}

<!-- ===== Pending ===== -->
<div class="status-card">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold mb-0">Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h5>
        <span class="badge bg-warning text-dark">
            â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
        </span>
    </div>

    <div class="info-row">
        <span>Ø§Ù„Ø­ÙŠ</span>
        <span>{{ active_request.subscription.neighborhood }}</span>
    </div>

    <div class="info-row">
        <span>Ø§Ù„Ø³Ø§Ø¦Ù‚</span>
        <span>{{ active_request.subscription.driver.user.get_full_name }}</span>
    </div>

    <div class="info-row">
        <span>Ø§Ù„Ø³Ø¹Ø±</span>
        <span>{{ active_request.price_snapshot }} Ø±.Ø³</span>
    </div>

    <form method="post" action="{% url 'student:cancel_request' active_request.id %}">
        {% csrf_token %}
        <button class="btn btn-outline-danger btn-sm mt-4">
            Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨
        </button>
    </form>

</div>


{% elif active_request.status == "approved" %}

<!-- ===== Approved ===== -->
<div class="status-card">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="fw-bold mb-0">Ø§Ø´ØªØ±Ø§ÙƒÙƒ Ù†Ø´Ø·</h5>
        <span class="badge bg-success">
            âœ… Ù†Ø´Ø·
        </span>
    </div>

    <div class="row g-4">

        <!-- Driver Info -->
        <div class="col-md-6">
            <div class="subscription-card">
                <h6 class="fw-bold mb-3">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù‚</h6>

                <div class="info-row">
                    <span>Ø§Ù„Ø§Ø³Ù…</span>
                    <span>{{ active_request.subscription.driver.user.get_full_name }}</span>
                </div>

                <div class="info-row">
                    <span>Ø§Ù„Ù‡Ø§ØªÙ</span>
                    <span>{{ active_request.subscription.driver.user.phone }}</span>
                </div>
            </div>
        </div>

        <!-- Subscription Info -->
        <div class="col-md-6">
            <div class="subscription-card">
                <h6 class="fw-bold mb-3">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h6>

                <div class="info-row">
                    <span>Ø§Ù„Ø­ÙŠ</span>
                    <span>{{ active_request.subscription.neighborhood }}</span>
                </div>

                <div class="info-row">
                    <span>Ø§Ù„Ø³Ø¹Ø±</span>
                    <span>{{ active_request.price_snapshot }} Ø±.Ø³</span>
                </div>

                <div class="info-row">
                    <span>Ø§Ù„Ù…Ø¯Ø©</span>
                    <span>{{ active_request.subscription.duration }}</span>
                </div>
            </div>
        </div>

    </div>

    <!-- ğŸ”¥ Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø© -->
    <div class="mt-4 text-end">
        <a href="{% url 'student:subscription_detail' active_request.id %}" class="btn btn-accent">
            Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©
        </a>
    </div>

</div>

{% endif %}

{% endblock %}