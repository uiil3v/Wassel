{% extends "driver/base_driver.html" %}

{% block driver_content %}

<style>
    /* ===== Card Base ===== */
    .profile-card {
        background: white;
        border-radius: 35px;
        padding: 40px;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.05);
        margin-bottom: 35px;
    }

    .profile-card h5 {
        font-weight: 700;
        margin-bottom: 25px;
    }

    /* ===== Status Bar ===== */
    .status-bar-wrapper {
        background: white;
        border-radius: 35px;
        padding: 35px;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.05);
        margin-bottom: 40px;
    }

    .status-progress {
        height: 8px;
        background: #eee;
        border-radius: 20px;
        overflow: hidden;
    }

    .status-progress-inner {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #d4af37);
    }

    /* ===== Inputs ===== */
    .premium-input {
        width: 100%;
        border-radius: 22px;
        padding: 14px 18px;
        border: 1.5px solid rgba(0, 0, 0, 0.08);
        background: #fdfcf9;
        transition: 0.3s ease;
    }

    .premium-input:focus {
        border-color: var(--accent-color);
        box-shadow: 0 10px 25px rgba(200, 169, 81, 0.2);
        outline: none;
    }

    /* ===== Document Box ===== */
    .doc-box {
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 25px;
        padding: 20px;
        text-align: center;
        transition: 0.3s ease;
        background: #faf9f6;
    }

    .doc-box:hover {
        transform: translateY(-5px);
    }

    .doc-preview {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 18px;
        margin-bottom: 15px;
    }

    /* Disabled */
    .disabled-overlay {
        opacity: 0.5;
        pointer-events: none;
    }
</style>


<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- ================= STATUS ================= -->
    <div class="status-bar-wrapper">

        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5>Ø­Ø§Ù„Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚</h5>

            {% if profile.verification_status == "approved" %}
            <span class="badge bg-success">Ù…Ø¹ØªÙ…Ø¯</span>
            {% elif profile.verification_status == "pending" %}
            <span class="badge bg-warning text-dark">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
            {% elif profile.verification_status == "rejected" %}
            <span class="badge bg-danger">Ù…Ø±ÙÙˆØ¶</span>
            {% else %}
            <span class="badge bg-secondary">ØºÙŠØ± Ù…ÙƒØªÙ…Ù„</span>
            {% endif %}
        </div>

        <div class="status-progress mb-3">
            <div class="status-progress-inner" style="width:
        {% if profile.verification_status == 'approved' %}100%
        {% elif profile.verification_status == 'pending' %}60%
        {% elif profile.verification_status == 'rejected' %}80%
        {% else %}20%
        {% endif %}
        ">
            </div>
        </div>

        <!-- ğŸ”´ Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ -->
        {% if profile.verification_status == "rejected" and profile.rejection_reason %}
        <div class="alert alert-danger mt-2 mb-0">
            <strong>Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:</strong>
            {{ profile.rejection_reason }}
        </div>
        {% endif %}

        <!-- ğŸŸ¢ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
        {% if profile.verification_status == "approved" %}
        <div class="alert alert-success mt-2 mb-0">
            ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø­Ø³Ø§Ø¨Ùƒ ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ğŸ‰
        </div>
        {% endif %}

    </div>


    <!-- ================= GENERAL INFO ================= -->
    <div class="profile-card {% if profile.verification_status == 'pending' %}disabled-overlay{% endif %}">
        <h5>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h5>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                <input type="text" name="first_name" value="{{ user.first_name }}" class="premium-input">
            </div>

            <div class="col-md-6 mb-3">
                <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</label>
                <input type="text" name="last_name" value="{{ user.last_name }}" class="premium-input">
            </div>

            <div class="col-md-6 mb-3">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" name="email" value="{{ user.email }}" class="premium-input">
            </div>

            <div class="col-md-6 mb-3">
                <label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                <input type="text" name="phone" value="{{ user.phone }}" class="premium-input text-start" dir="ltr"
                    style="direction: ltr; text-align: left;">
            </div>
        </div>
    </div>


    <!-- ================= DRIVER DOCUMENTS ================= -->
    <div class="profile-card">
        <h5>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù‚</h5>

        <div class="row g-4">

            <!-- ID -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">ØµÙˆØ±Ø© Ø§Ù„Ù‡ÙˆÙŠØ©</h6>

                    {% if profile.id_document_image %}
                    <img src="{{ profile.id_document_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="id_document_image" class="form-control">
                </div>
            </div>

            <!-- License -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</h6>

                    {% if profile.driving_license_image %}
                    <img src="{{ profile.driving_license_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="driving_license_image" class="form-control">
                </div>
            </div>

        </div>
    </div>


    <!-- ================= VEHICLE DATA ================= -->
    <div class="profile-card {% if profile.verification_status == 'pending' %}disabled-overlay{% endif %}">
        <h5>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h5>

        <!-- Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© -->
        <div class="row mb-4">
            <div class="col-md-6">
                <label>Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
                <input type="text" name="vehicle_model" value="{{ profile.vehicle_model }}" class="premium-input">
            </div>
        </div>

        <div class="row g-4">

            <!-- Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h6>

                    {% if profile.vehicle_registration_image %}
                    <img src="{{ profile.vehicle_registration_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="vehicle_registration_image" class="form-control">
                </div>
            </div>

            <!-- ØªØ£Ù…ÙŠÙ† Ø§Ù„Ù…Ø±ÙƒØ¨Ø© -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">ØªØ£Ù…ÙŠÙ† Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h6>

                    {% if profile.vehicle_insurance_image %}
                    <img src="{{ profile.vehicle_insurance_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="vehicle_insurance_image" class="form-control">
                </div>
            </div>

            <!-- ØµÙˆØ±Ø© Ø£Ù…Ø§Ù…ÙŠØ© -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">ØµÙˆØ±Ø© Ø£Ù…Ø§Ù…ÙŠØ© Ù„Ù„Ù…Ø±ÙƒØ¨Ø©</h6>

                    {% if profile.vehicle_front_image %}
                    <img src="{{ profile.vehicle_front_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="vehicle_front_image" class="form-control">
                </div>
            </div>

            <!-- ØµÙˆØ±Ø© Ø®Ù„ÙÙŠØ© -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">ØµÙˆØ±Ø© Ø®Ù„ÙÙŠØ© Ù„Ù„Ù…Ø±ÙƒØ¨Ø©</h6>

                    {% if profile.vehicle_back_image %}
                    <img src="{{ profile.vehicle_back_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="vehicle_back_image" class="form-control">
                </div>
            </div>

            <!-- ØµÙˆØ±Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© -->
            <div class="col-md-4">
                <div class="doc-box">
                    <h6 class="mb-3">ØµÙˆØ±Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© Ù„Ù„Ù…Ø±ÙƒØ¨Ø©</h6>

                    {% if profile.vehicle_side_image %}
                    <img src="{{ profile.vehicle_side_image.url }}" class="doc-preview">
                    {% endif %}

                    <input type="file" name="vehicle_side_image" class="form-control">
                </div>
            </div>

        </div>
    </div>


    <!-- ================= SAVE BUTTON ================= -->
    {% if profile.verification_status != "pending" %}
    <div class="text-end mt-4">
        <button type="submit" class="btn btn-accent px-5 py-2">
            Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ÙˆØ¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
        </button>
    </div>
    {% else %}
    <div class="alert alert-warning mt-4">
        Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.
    </div>
    {% endif %}

</form>

{% endblock %}